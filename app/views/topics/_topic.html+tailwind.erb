<% followers = topic.followers %>
<div class="flex flex-wrap">
	<h1 class="font-semibold text-3xl"><%= topic.display_name %></h1>
</div>
<div class="flex flex-wrap">
	<div class="mb-4">
		<nav aria-label="breadcrumb">
			<ol class="flex flex-wrap list-reset pt-3 pb-3 py-4 px-4 mb-4 bg-grey-light rounded bg-transparent text-sm p-0">
				<li class="inline-block px-2 py-2 text-grey-dark"><a href="/topics">All Topics</a></li>
				<% topic.ancestors.each do |par| %>
					<li class="inline-block px-2 py-2 text-grey-dark active" aria-current="page"><%= link_to topic_path(par) do %><%= par.display_name %><% end %></li>
				<% end %>
			</ol>
		</nav>
	</div>
</div>
<div class="flex flex-wrap">
	<h1 class="md:w-2/3 pr-4 pl-4 mb-4">
	<% if current_user %>
	<%= link_to toggle_follow_topic_path(topic), method: :post, class: "p-2 mr-2 rounded-lg text-white " + (@does_follow ? "bg-red-500" : "bg-green-500") do %>
		<%= (@does_follow ? "Unfollow" : "Follow")%>
	<% end %>
	<% end %>
	<%= link_to "Add New Item", new_item_path(topic: topic.id), class: "p-2 mr-2 bg-orange-500 rounded-lg text-white " %>
 	<% if current_user.try(:can_add_syllabus?) %>
    	<%= link_to "Add New Learning Plan", new_syllabus_items_path(topic: topic.id), class: "p-2 mr-2 bg-orange-500 rounded-lg text-white " %>
  	<% end %>
  	<% if current_user.try(:can_merge_topic?) %>
    	<%= link_to "Merge", merge_topic_path(topic), class: "p-2 mr-2 bg-orange-500 rounded-lg text-white " %>
  	<% end %>
  	<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flearnawesome.org%2Ftopics%2F<%= topic.id %>&src=sdkpreparse" target="_blank"><i class="fab fa-facebook"></i></a>
  	<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnawesome.org%2Ftopics%2F<%= topic.id %>" target="_blank"><i class="fab fa-twitter"></i></a>
	</h1>
</div>
<div class="mb-4">
	<% if topic.all_children.present? %>
		<b>Related: </b>
		<% topic.all_children.take(5).each do |tt| %>
			<%= link_to tt.display_name_without_ancestors, topic_path(tt), class: 'p-2 mr-2 rounded-lg ' %>
		<% end%>
		<%= link_to(" and #{topic.all_children.count - 5 } others", explore_topic_path(topic, show_max: 100)) if topic.all_children.count > 5 %>
	<% end %>
	<% if topic.experts.present? %>
		<%= number_to_human(topic.experts.count) %>
		<%= "expert".pluralize(topic.experts.size) %>:
		<% topic.experts.take(5).each do |c| %>
			<%= link_to c.name, person_path(c), class: 'btn btn-sm btn-soft-info btn-pill' %>
		<% end%>
		<%= " and #{topic.experts.count - 5 } others" if topic.experts.count > 5 %>
	<% end %>
	<br/><br/>
	<% if followers.present? %>
		<%= number_to_human(followers.count) %>
		<%= "follower".pluralize(followers.count) %>:
		<% followers[0..4].each do |c| %>
			<%= link_to c.nickname, user_path(c), class: 'btn btn-sm btn-soft-info btn-pill' %>
		<% end %>
		<%= " and #{followers.count - 5 } others" if followers.count > 5 %>
	<% end %>
</div>

<% @item_type_items.group_by(&:item_type_id).sort_by { |itid,items| [ itid == 'learning_plan' ? 0 : 1, itid ] }.to_h.each do |itid, items| %>
<div class="mt-6">
<div class="px-4 xl:px-8">
    <h3 class="text-gray-900 text-xl"><%= ItemType.find(itid).display_name_plural %></h3>
    <!-- <p class="text-gray-600">Live like the stars in these luxurious Southern California estates.</p> -->
</div>
<div class="mt-6 sm:overflow-x-auto sm:overflow-y-hidden">
	<div class="px-4 sm:inline-flex sm:pt-2 sm:pb-8 xl:px-8 flex-wrap">
	<% items.each do |item| %>
		<%= render partial: 'item', locals: {item: item} %>
	<% end %>
	</div>
</div>
<% end %>